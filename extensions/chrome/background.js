(()=>{const e=new Map;function n(n,t){const o=function(n){return e.has(n)||e.set(n,new Map),e.get(n)}(t);o.has(n.name)||o.set(n.name,[]);const s=o.get(n.name);s.includes(n)||(s.push(n),n.onDisconnect.addListener(()=>{console.log(`[WebGPU Inspector] Port disconnected: ${n.name} (tab ${t})`),s.includes(n)&&s.splice(s.indexOf(n),1),0===s.length&&o.delete(n.name),0===o.size&&e.delete(t)}),console.log(`[WebGPU Inspector] Port registered: ${n.name} (tab ${t})`))}chrome.runtime.onConnect.addListener(t=>{console.log(`[WebGPU Inspector] Port connecting: ${t.name}`);let o=!1;t.onMessage.addListener((t,s)=>{const a=void 0!==t.tabId?t.tabId:s.sender?.tab?.id??0;o||(n(s,a),o=!0);const c=e.get(a);if(!c)return void console.error(`[WebGPU Inspector] No port map found for tab ${a}`);const r=(e,n)=>{e.forEach(e=>{try{e.postMessage(n)}catch(n){console.error(`[WebGPU Inspector] Failed to post message to port ${e.name}:`,n)}})};'webgpu-inspector-panel'===s.name&&c.has('webgpu-inspector-page')&&r(c.get('webgpu-inspector-page'),t),'webgpu-inspector-page'===s.name&&c.has('webgpu-inspector-panel')&&r(c.get('webgpu-inspector-panel'),t)})})})();
//# sourceMappingURL=background.js.map
