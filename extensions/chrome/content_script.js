!function(){const e={CaptureBufferData:'webgpu_inspect_capture_buffer_data',CaptureBuffers:'webgpu_inspect_capture_buffers',DeleteObjects:'webgpu_inspect_delete_objects',ValidationError:'webgpu_inspect_validation_error',MemoryLeakWarning:'webgpu_inspect_memory_leak_warning',DeltaTime:'webgpu_inspect_delta_time',CaptureFrameResults:'webgpu_inspect_capture_frame_results',CaptureFrameCommands:'webgpu_inspect_capture_frame_commands',ObjectSetLabel:'webgpu_inspect_object_set_label',AddObject:'webgpu_inspect_add_object',ResolveAsyncObject:'webgpu_inspect_resolve_async_object',DeleteObject:'webgpu_inspect_delete_object',CaptureTextureFrames:'webgpu_inspect_capture_texture_frames',CaptureTextureData:'webgpu_inspect_capture_texture_data',CaptureBufferData:'webgpu_inspect_capture_buffer_data',Recording:'webgpu_record_recording',RecordingCommand:'webgpu_record_command',RecordingDataCount:'webgpu_record_data_count',RecordingData:'webgpu_record_data'};e.values=new Set(Object.values(e));const t='webgpu_inspect_request_texture',s='webgpu_inspect_compile_shader',r='webgpu_inspect_revert_shader',n='webgpu_inspector_capture',o='webgpu_initialize_inspector',a='webgpu_initialize_recorder',i='WEBGPU_INSPECTOR_LOADED',c='WEBGPU_RECORDER_LOADED',_=new class p{constructor(e,t,s){this.name=e,this.tabId=t??0,this.listeners=[],s&&this.listeners.push(s),this._port=null,this.reset()}reset(){const e=this;this._port=chrome.runtime.connect({name:this.name}),this._port.onDisconnect.addListener((()=>{e.reset()})),this._port.onMessage.addListener((t=>{for(const s of e.listeners)s(t)}))}addListener(e){this.listeners.push(e)}postMessage(e){e.__webgpuInspector=!0,this.tabId&&(e.tabId=this.tabId);try{this._port.postMessage(e)}catch(e){this.reset()}}}('webgpu-inspector-page',0,(e=>{let _=e.action;if(!_)return;if(_===t||_===s||_===r)return void window.dispatchEvent(new CustomEvent('__WebGPUInspector',{detail:e}));if(_===a)return sessionStorage.setItem(c,`${e.frames}%${e.filename}%${e.download}`),void setTimeout((()=>{window.location.reload()}),50);let p='true';if(_===n){const t=JSON.stringify(e);if(e.frame>=0)_=o,p=t;else{sessionStorage.setItem('WEBGPU_INSPECTOR_CAPTURE_FRAME',t);const e={__webgpuInspector:!0,__webgpuInspectorPanel:!0,action:n,data:t};window.dispatchEvent(new CustomEvent('__WebGPUInspector',{detail:e}))}}_===o&&(sessionStorage.setItem(i,p),setTimeout((()=>{window.location.reload()}),50))}));function u(e,t,s){const r=document.createElement('script');if(r.id=e,r.src=t,s)for(const e in s)r.setAttribute(e,s[e]);(document.head||document.documentElement).appendChild(r)}if(window.addEventListener('pageshow',(e=>{e.persisted&&_.reset()})),window.addEventListener('__WebGPUInspector',(t=>{const s=t.detail;if('object'!=typeof s||null===s)return;const r=s.action;if(e.values.has(r))try{_.postMessage(s)}catch(e){}})),window.addEventListener('__WebGPURecorder',(t=>{const s=t.detail;if('object'!=typeof s||null===s)return;const r=s.action;if(e.values.has(r))try{_.postMessage(s)}catch(e){}})),-1===navigator.userAgent.indexOf('Chrom')&&(-1!==navigator.userAgent.indexOf('Safari')||-1!==navigator.userAgent.indexOf('Firefox'))){sessionStorage.getItem(i)&&(console.log('[WebGPU Inspector] Fallback injection'),u('__webgpu_inspector',chrome.runtime.getURL('webgpu_inspector_loader.js')));const e=sessionStorage.getItem(c);if(e){sessionStorage.removeItem(c);const t=e.split('%');u('__webgpu_recorder',chrome.runtime.getURL('webgpu_recorder_loader.js'),{filename:t[1],frames:t[0],download:t[2],removeUnusedResources:1,messageRecording:1})}}_.postMessage({action:'PageLoaded'})}();
//# sourceMappingURL=content_script.js.map
